
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Tron Blog!">
    <title>标签: React - Tron Blog!</title>
    <meta name="author" content="Archie Shi">
    
    
    
    <meta name="description" content="Archie&apos;s Blog">
<meta property="og:type" content="blog">
<meta property="og:title" content="Tron Blog!">
<meta property="og:url" content="https://shianqi.github.io/tags/React/index.html">
<meta property="og:site_name" content="Tron Blog!">
<meta property="og:description" content="Archie&apos;s Blog">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tron Blog!">
<meta name="twitter:description" content="Archie&apos;s Blog">
    
    
        
    
    
        <meta property="og:image" content="http://cdn.shianqi.com/20171110003439_iub77X_cat_sm.png"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="../../assets/css/font-awesome.css">
    <link rel="stylesheet" href="../../assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="../../assets/css/jquery.fancybox-thumbs.css">
    <link rel="stylesheet" href="../../assets/css/tranquilpeak.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="../../ ">Tron Blog!</a>
    </div>
    
        
            <a  class="header-right-icon open-algolia-search"
                href="#about">
        
        
            <i class="fa fa-lg fa-search"></i>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="../../#about">
                    <img class="sidebar-profile-picture" src="http://cdn.shianqi.com/20171110003439_iub77X_cat_sm.png" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">Archie Shi</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Nothing to say</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="../../ "
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="../../all-tags"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="../../all-archives"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                        <span class="sidebar-button-desc">搜索</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/shianqi" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="tencent://message/?uin=1210219084&Site=有事Q我&Menu=yes" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-qq"></i>
                        <span class="sidebar-button-desc">QQ</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:shianqi@imudges.com" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/10/07/React/React_16.0/">
                            React v16.0 新特性
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-10-07T15:48:16+08:00">
	
		    10月 07, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="React-v16-0"><a href="#React-v16-0" class="headerlink" title="React v16.0"></a>React v16.0</h1><h2 id="新的渲染返回类型：碎片和字符串"><a href="#新的渲染返回类型：碎片和字符串" class="headerlink" title="新的渲染返回类型：碎片和字符串"></a>新的渲染返回类型：碎片和字符串</h2><p>现在可以从组件的渲染方法中返回一个包含元素的数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="comment">// No need to wrap list items in an extra element!</span></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="comment">// Don't forget the keys :)</span></span><br><span class="line">    &lt;li key=<span class="string">"A"</span>&gt;First item&lt;<span class="regexp">/li&gt;,</span></span><br><span class="line"><span class="regexp">    &lt;li key="B"&gt;Second item&lt;/</span>li&gt;,</span><br><span class="line">    &lt;li key=<span class="string">"C"</span>&gt;Third item&lt;<span class="regexp">/li&gt;,</span></span><br><span class="line"><span class="regexp">  ];</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>添加了对返回字符串的支持</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Look ma, no spans!'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="更好的服务端渲染"><a href="#更好的服务端渲染" class="headerlink" title="更好的服务端渲染"></a>更好的服务端渲染</h2><p><code>React 16</code> 完全重写服务器渲染，支持流。同时编译不再进行 <code>process.env</code> 检查（Node 读取 <code>process.env</code> 非常慢）。并且比 <code>React 15</code> 快大概三倍</p>
<h2 id="支持自定义-DOM-属性"><a href="#支持自定义-DOM-属性" class="headerlink" title="支持自定义 DOM 属性"></a>支持自定义 DOM 属性</h2><p><code>React</code> 现在会将自定义属性传递给 <code>DOM</code>，而不是忽略不认识的 <code>HTML</code> 和 <code>SVG</code> 属性。这使得我们能够不必在维护的 <code>React</code> 特性的白名单，并能够减少文件体积</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Your code:</span></span><br><span class="line">&lt;div mycustomattribute=<span class="string">"something"</span> /&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React 15 output:</span></span><br><span class="line">&lt;div /&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React 16 output:</span></span><br><span class="line">&lt;div mycustomattribute=<span class="string">"something"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="减少文件体积"><a href="#减少文件体积" class="headerlink" title="减少文件体积"></a>减少文件体积</h2><p><code>React</code> 现在使用 <code>Rollup</code> 来进行扁平化的打包以处理不同目标格式，而这使得体积和性能都有了提高。<strong>相较于之前的版本体积减少了32%</strong></p>
<h2 id="MIT-协议"><a href="#MIT-协议" class="headerlink" title="MIT 协议"></a>MIT 协议</h2><h2 id="新核心架构"><a href="#新核心架构" class="headerlink" title="新核心架构"></a>新核心架构</h2><p>异步渲染 - 一种周期性地对浏览器执行调度渲染工作的策略。结果如下，通过异步渲染，应用能够更好的响应，因为 React 避免阻塞了主线程。</p>
<h2 id="新的弃用"><a href="#新的弃用" class="headerlink" title="新的弃用"></a>新的弃用</h2><p>保留（Hydrating）服务端渲染的容器现在有了更清晰的 <code>API</code> 定义。若你想重用服务端渲染的 <code>HTML</code>，使用 <code>ReactDOM.hydrate</code> 而不是 <code>ReactDOM.render</code>。若你只是想做客户端渲染则继续使用 <code>ReactDOM.render</code> 即可。</p>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><ul>
<li><p>React 15 已对使用 <code>unstable_handleError</code> 进行了限制，不再为错误边界提供文档支持。该方法已重命名为 <code>componentDidCatch</code>。你可以使用 <code>codemod</code> 来自动地迁移代码到新的 <code>API</code>。</p>
</li>
<li><p>通过 <code>null</code> 调用 <code>setState</code> 不再触发更新。这允许你确定在更新函数里你是否想要重新渲染。</p>
</li>
<li><p><code>setState</code> 回调函数（第二个参数）现在会在 <code>componentDidMount / componentDidUpdate</code> 之后立刻触发，而非等到所有组件都已渲染。</p>
</li>
<li><p>当使用 <code>&lt;B /&gt;</code> 来替换 <code>&lt;A /&gt;</code>，<code>B.componentWillMount</code> 现在会在 <code>A.componentWillUnmount</code> 之前触发。之前，在某些情况下，<code>A.componentWillUnmount</code> 会立刻触发。</p>
</li>
</ul>
<h2 id="JavaScript环境要求"><a href="#JavaScript环境要求" class="headerlink" title="JavaScript环境要求"></a>JavaScript环境要求</h2><p><code>React 16</code> 依赖于集合类型 <code>Map</code> 和 <code>Set</code>。若你要支持老式的可能未提供原生支持的浏览器和设备（例如 IE &lt; 11），考虑在你的应用库中包含一个全局的 <code>polyfill</code>，例如 <code>core-js</code> 或 <code>babel-polyfill</code>。</p>
<p>一个使用 core-js 支持老版浏览器的 React 16 polyfill 环境大致如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'core-js/es6/map'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'core-js/es6/set'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;h1&gt;Hello, world!<span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
                    
                        
                    
                    
                        <p>
                            <a href="../../2017/10/07/React/React_16.0/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/09/14/React/props_children/">
                            this.props.children
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-09-14T17:09:16+08:00">
	
		    9月 14, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="this-props-children"><a href="#this-props-children" class="headerlink" title="this.props.children"></a>this.props.children</h1><p><code>this.props</code> 对象的属性与组件的属性一一对应，但是有一个例外，就是 <code>this.props.children</code> 属性。它表示组件的所有子节点</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> NotesList = React.createClass(&#123;</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;ol&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        React.Children.map(<span class="keyword">this</span>.props.children, <span class="function"><span class="keyword">function</span> (<span class="params">child</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;child&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      &lt;<span class="regexp">/ol&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;NotesList&gt;</span></span><br><span class="line"><span class="regexp">    &lt;span&gt;hello&lt;/</span>span&gt;</span><br><span class="line">    &lt;span&gt;world&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>NotesList&gt;,</span><br><span class="line">  <span class="built_in">document</span>.body</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>这里需要注意， <code>this.props.children</code> 的值有三种可能：如果当前组件没有子节点，它就是 <code>undefined</code> ;如果有一个子节点，数据类型是 <code>object</code> ；如果有多个子节点，数据类型就是 <code>array</code> 。所以，处理 <code>this.props.children</code> 的时候要小心。</p>
<p><code>React</code> 提供一个工具方法 <code>React.Children</code> 来处理 <code>this.props.children</code> 。我们可以用 <code>React.Children.map</code> 来遍历子节点，而不用担心 <code>this.props.children</code> 的数据类型是 <code>undefined</code> 还是 <code>object</code>。更多的 <code>React.Children</code> 的方法，请参考官方文档。</p>

                    
                        
                    
                    
                        <p>
                            <a href="../../2017/09/14/React/props_children/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/06/11/React/React生命周期/">
                            React 生命周期
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-06-11T15:51:56+08:00">
	
		    6月 11, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h3 id="初始化阶段："><a href="#初始化阶段：" class="headerlink" title="初始化阶段："></a>初始化阶段：</h3><table>
<thead>
<tr>
<th>函数名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>constructor(props)</code></td>
<td>构造函数</td>
</tr>
<tr>
<td><code>componentWillMount</code></td>
<td>render之前最后一次修改状态的机会</td>
</tr>
<tr>
<td><code>render</code></td>
<td>只能访问this.props和this.state,只有一个顶层组件，不允许修改状态和DOM输出</td>
</tr>
<tr>
<td><code>componentDidMount</code></td>
<td>成功render并渲染完成真实DOM之后触发，可以修改DOM</td>
</tr>
</tbody>
</table>
<h3 id="运行中阶段："><a href="#运行中阶段：" class="headerlink" title="运行中阶段："></a>运行中阶段：</h3><table>
<thead>
<tr>
<th>函数名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>componentWillReceiveProps</code></td>
<td>父组件修改属性触发，可以修改属性、修改状态</td>
</tr>
<tr>
<td><code>shouldComponentUpdate</code></td>
<td>组件是否要更新，返回false会阻止render调用</td>
</tr>
<tr>
<td><code>componentWillUnpdate</code></td>
<td>不能修改状态和属性</td>
</tr>
<tr>
<td><code>render</code></td>
<td>只能访问this.props和this.state,不允许修改状态和DOM输出</td>
</tr>
<tr>
<td><code>componentDidUpdate</code></td>
<td>可以修改DOM</td>
</tr>
</tbody>
</table>
<h3 id="销毁阶段："><a href="#销毁阶段：" class="headerlink" title="销毁阶段："></a>销毁阶段：</h3><table>
<thead>
<tr>
<th>函数名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>componentWillUnmount</code></td>
<td>在删除组件之前进行清理操作，比如计时器和事件处理器</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line"></span><br><span class="line">class GD extends Component&#123;</span><br><span class="line"></span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props)</span><br><span class="line">        console.log(&apos;constructor&apos;)</span><br><span class="line">        this.state = &#123;</span><br><span class="line">            shrinkState: true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">        console.log(&apos;componentWillMount&apos;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h3&gt;GD&lt;/h3&gt;</span><br><span class="line">                &lt;input</span><br><span class="line">                    type=&quot;button&quot;</span><br><span class="line">                    onClick=&#123;()=&gt;&#123;</span><br><span class="line">                        this.setState(&#123;</span><br><span class="line">                            shrinkState: false</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;&#125;</span><br><span class="line">                    value=&#123;this.props.name&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        console.log(&apos;componentDidMount&apos;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillReceiveProps() &#123;</span><br><span class="line">        console.log(&apos;componentWillReceiveProps: 父组件修改属性触发&apos;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    shouldComponentUpdate() &#123;</span><br><span class="line">        console.log(&apos;shouldComponentUpdate&apos;)</span><br><span class="line">        return true</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillUpdate() &#123;</span><br><span class="line">        console.log(&apos;componentWillUpdate&apos;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidUpdate() &#123;</span><br><span class="line">        console.log(&apos;componentDidUpdate&apos;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillUnmount ()&#123;</span><br><span class="line">        console.log(&apos;componentWillUnmount&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default GD</span><br></pre></td></tr></table></figure>
                    
                        
                    
                    
                        <p>
                            <a href="../../2017/06/11/React/React生命周期/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/06/11/React-router/history/">
                            react-router history
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-06-11T10:57:56+08:00">
	
		    6月 11, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="histroy-属性"><a href="#histroy-属性" class="headerlink" title="histroy 属性"></a>histroy 属性</h1><p>Router组件的history属性，用来监听浏览器地址栏的变化，并将URL解析成一个地址对象，供 <code>React Router</code> 匹配。<br>history属性，一共可以设置三种值。</p>
<ul>
<li><code>browserHistory</code></li>
<li><code>hashHistory</code></li>
<li><code>createMemoryHistory</code><br>如果设为 <code>hashHistory</code>，路由将通过URL的hash部分（#）切换，URL的形式类似 <code>example.com/#/some/path</code>。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; hashHistory &#125; from &apos;react-router&apos;</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;Router history=&#123;hashHistory&#125; routes=&#123;routes&#125; /&gt;,</span><br><span class="line">  document.getElementById(&apos;app&apos;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果设为 <code>browserHistory</code>，浏览器的路由就不再通过Hash完成了，而显示正常的路径 <code>example.com/some/path</code>，背后调用的是浏览器的 <code>History API</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; browserHistory &#125; from &apos;react-router&apos;</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;Router history=&#123;browserHistory&#125; routes=&#123;routes&#125; /&gt;,</span><br><span class="line">  document.getElementById(&apos;app&apos;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>但是，这种情况需要对服务器改造。否则用户直接向服务器请求某个子路由，会显示网页找不到的404错误。<br>如果开发服务器使用的是 <code>webpack-dev-server</code>，加上 <code>--history-api-fallback</code>参数就可以了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ webpack-dev-server --inline --content-base . --history-api-fallback</span><br></pre></td></tr></table></figure>
<p>或者在 <code>webpack.config.js</code> 配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    historyApiFallback: true,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>createMemoryHistory主要用于服务器渲染。它创建一个内存中的history对象，不与浏览器URL互动。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const history = createMemoryHistory(location)</span><br></pre></td></tr></table></figure>
                    
                        
                    
                    
                        <p>
                            <a href="../../2017/06/11/React-router/history/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/05/31/Redux/Redux/">
                            Redux 笔记
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-05-31T15:13:16+08:00">
	
		    5月 31, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><h2 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h2><p><code>JavaScript</code> 需要更多的 <code>state</code>，<code>Redux</code> 试图让 <code>state</code> 的变化变得可预测。</p>
<h2 id="三大原则"><a href="#三大原则" class="headerlink" title="三大原则"></a>三大原则</h2><h3 id="单一数据源"><a href="#单一数据源" class="headerlink" title="单一数据源"></a>单一数据源</h3><p>整个应用的 <code>state</code> 被储存在一棵 <code>object tree</code> 中，并且这个 <code>object tree</code> 只存在于唯一一个 <code>store</code> 中</p>
<h3 id="State-是只读的"><a href="#State-是只读的" class="headerlink" title="State 是只读的"></a>State 是只读的</h3><p>惟一改变 <code>state</code> 的方法就是触发 <code>action</code>，<code>action</code>(表达想要修改的意图) 是一个用于描述已发生事件的普通对象。</p>
<h3 id="使用纯函数来执行修改"><a href="#使用纯函数来执行修改" class="headerlink" title="使用纯函数来执行修改"></a>使用纯函数来执行修改</h3><p>为了描述 <code>action</code> 如何改变 <code>state tree</code> ，你需要编写 <code>reducers</code>。</p>
<p>Reducer 只是一些纯函数，它接收先前的 state 和 action，并返回新的 state。</p>
<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h2><p>Action 是把数据从应用传到 store 的有效载荷。它是 store 数据的唯一来源。一般来说你会通过 store.dispatch() 将 action 传到 store。</p>
<p>Action 本质上是 JavaScript 普通对象。我们约定，action 内必须使用一个字符串类型的 type 字段来表示将要执行的动作。</p>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: ADD_TODO,</span><br><span class="line">  text: &apos;Build my first Redux app&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>action 对象的结构完全由自己决定，但是为了多人合作方便，最好遵循一定的标准 <a href="https://github.com/acdlite/flux-standard-action" target="_blank" rel="external">Flux 标准 Action</a></p>
<p><code>store</code> 里能直接通过 <code>store.dispatch()</code> 调用 <code>dispatch()</code></p>
<p>但是多数情况下你会使用 <a href="http://github.com/gaearon/react-redux" target="_blank" rel="external"><code>react-redux</code></a> 提供的 <code>connect()</code> 帮助器来调用。<a href="http://www.redux.org.cn/docs/api/bindActionCreators.html" target="_blank" rel="external"><code>bindActionCreators()</code></a> 可以自动把多个 <code>action</code> 创建函数 绑定到 <code>dispatch()</code> 方法上。</p>
<h2 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h2><h3 id="处理-action"><a href="#处理-action" class="headerlink" title="处理 action"></a>处理 action</h3><p><code>reducer</code> 就是一个纯函数，接收旧的 <code>state</code> 和 <code>action</code>，返回新的 <code>state</code>。持 reducer 纯净非常重要。永远不要在 reducer 里做这些操作：</p>
<ul>
<li>修改传入参数</li>
<li>执行有副作用的操作，如 API 请求和路由跳转</li>
<li>调用非纯函数，如 Date.now() 或 Math.random()</li>
</ul>
<p>建议你尽可能地把 <code>state</code> 范式化，不存在嵌套。把应用的 <code>state</code> 想像成数据库。只要传入参数相同，返回计算得到的下一个 <code>state</code> 就一定相同。没有特殊情况、没有副作用，没有 <code>API</code> 请求、没有变量修改，单纯执行计算。</p>
<p><strong>注意:</strong></p>
<ul>
<li>不要修改 <code>state</code>，使用 <code>Object.assign()</code> 新建了一个副本。不能这样使用 <code>Object.assign(state, { visibilityFilter: action.filter })</code>，因为它会改变第一个参数的值。你必须把第一个参数设置为空对象。你也可以开启对ES7提案对象展开运算符的支持, 从而使用 <code>{ ...state, ...newState }</code> 达到相同的目的。</li>
<li>在 <code>default</code> 情况下返回旧的 <code>state</code></li>
</ul>
<h3 id="拆分-Reducer"><a href="#拆分-Reducer" class="headerlink" title="拆分 Reducer"></a>拆分 Reducer</h3><p><code>Redux</code> 提供了 <code>combineReducers()</code> 工具类来合并拆分的 <code>Reducer</code></p>
<h2 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h2><p><strong>Redux 应用只有一个单一的 store</strong></p>
<p>Store 就是把 <code>Action</code>，<code>Reducer</code> 联系到一起的对象。Store 有以下职责：</p>
<ul>
<li>维持应用的 state；</li>
<li>提供 getState() 方法获取 state；</li>
<li>提供 dispatch(action) 方法更新 state；</li>
<li>通过 subscribe(listener) 注册监听器;</li>
<li>通过 subscribe(listener) 返回的函数注销监听器。</li>
</ul>
<p><code>createStore()</code> 的第二个参数是可选的, 用于设置 <code>state</code> 初始状态。</p>
<h2 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h2><p><strong>严格的单向数据流</strong>是 Redux 架构的设计核心。</p>
<p>Redux 应用中数据的生命周期遵循下面 4 个步骤：</p>
<ol>
<li>调用 <code>store.dispatch(action)</code></li>
<li><p><code>Redux store</code> 调用传入的 <code>reducer</code> 函数。</p>
<p> Store 会把两个参数传入 reducer： 当前的 state 树和 action。</p>
</li>
<li>根 reducer 应该把多个子 reducer 输出合并成一个单一的 state 树。</li>
<li>Redux store 保存了根 reducer 返回的完整 state 树。 </li>
</ol>
<h2 id="搭配-React"><a href="#搭配-React" class="headerlink" title="搭配 React"></a>搭配 React</h2><h3 id="安装-React-Redux"><a href="#安装-React-Redux" class="headerlink" title="安装 React Redux"></a>安装 React Redux</h3><p>Redux 默认并不包含 React 绑定库，需要单独安装。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-redux</span><br></pre></td></tr></table></figure></p>
<h3 id="connect"><a href="#connect" class="headerlink" title="connect()"></a>connect()</h3><p>我们想要通过 <code>react-redux</code> 提供的 <code>connect()</code> 方法将包装好的组件连接到 <code>Redux</code>。尽量只做一个顶层的组件，或者 <code>route</code> 处理。从技术上来说你可以将应用中的任何一个组件 <code>connect()</code> 到 <code>Redux store</code> 中，但尽量避免这么做，因为这个数据流很难追踪。</p>
<p><strong>任何一个从 <code>connect()</code> 包装好的组件都可以得到一个 <code>dispatch</code> 方法作为组件的 <code>props</code>，以及得到全局 <code>state</code> 中所需的任何内容。</strong><code>connect()</code> 的唯一参数是 <strong><code>selector</code></strong>。此方法可以从 <code>Redux store</code> 接收到全局的 <code>state</code>，然后返回组件中需要的 <code>props</code>。最简单的情况下，可以返回一个初始的 <code>state</code> （例如，返回认证方法），但最好先将其进行转化。</p>
<p><code>selector</code>  的作用就是为 <code>React Components</code> 构造适合自己需要的状态视图。是一个自定义函数，selector 的实现完全是自定义函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    // 通过调用 connect() 注入:</span><br><span class="line">    const &#123; dispatch, visibleTodos, visibilityFilter &#125; = this.props</span><br><span class="line">    return (</span><br><span class="line">      ...</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">App.propTypes = &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 基于全局 state ，哪些是我们想注入的 props ?</span><br><span class="line">// 注意：使用 https://github.com/reactjs/reselect 效果更佳。</span><br><span class="line">function select(state) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    visibilityFilter: state.visibilityFilter</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 包装 component ，注入 dispatch 和 state 到其默认的 connect(select)(App) 中；</span><br><span class="line">export default connect(select)(App);</span><br></pre></td></tr></table></figure>
<p><code>reselect</code> 这个项目提供了带 <code>cache</code> 功能的 <code>selector</code>。如果  <code>Store/State</code> 和构造 <code>view</code> 的参数没有变化，那么每次 <code>Component</code> 获取的数据都将来自于上次调用/计算的结果。得益于 <code>Store/State Immutable</code> 的本质，状态变化的检测是非常高效的。</p>
<h1 id="高级"><a href="#高级" class="headerlink" title="高级"></a>高级</h1><h2 id="异步Action"><a href="#异步Action" class="headerlink" title="异步Action"></a>异步Action</h2><p>当调用异步 API 时，有两个非常关键的时刻：发起请求的时刻，和接收到响应的时刻 （也可能是超时）。</p>
<p>这两个时刻都可能会更改应用的 state；为此，你需要 dispatch 普通的同步 action。一般情况下，每个 API 请求都需要 dispatch 至少三种 action：</p>
<ol>
<li><p>一种通知 reducer 请求开始的 action。</p>
<p> 对于这种 action，reducer 可能会切换一下 state 中的 isFetching 标记。以此来告诉 UI 来显示进度条。</p>
</li>
<li><p>一种通知 reducer 请求成功结束的 action。</p>
<p> 对于这种 action，reducer 可能会把接收到的新数据合并到 state 中，并重置 isFetching。UI 则会隐藏进度条，并显示接收到的数据。</p>
</li>
<li><p>一种通知 reducer 请求失败的 action。</p>
<p> 对于这种 action，reducer 可能会重置 isFetching。或者，有些 reducer 会保存这些失败信息，并在 UI 里显示出来。</p>
</li>
</ol>
<p>为了区分这三种 action，可能在 action 里添加一个专门的 status 字段作为标记位：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; type: &apos;FETCH_POSTS&apos; &#125;</span><br><span class="line">&#123; type: &apos;FETCH_POSTS&apos;, status: &apos;error&apos;, error: &apos;Oops&apos; &#125;</span><br><span class="line">&#123; type: &apos;FETCH_POSTS&apos;, status: &apos;success&apos;, response: &#123; ... &#125; &#125;</span><br></pre></td></tr></table></figure>
<p>又或者为它们定义不同的 type：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; type: &apos;FETCH_POSTS_REQUEST&apos; &#125;</span><br><span class="line">&#123; type: &apos;FETCH_POSTS_FAILURE&apos;, error: &apos;Oops&apos; &#125;</span><br><span class="line">&#123; type: &apos;FETCH_POSTS_SUCCESS&apos;, response: &#123; ... &#125; &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="异步-Action-Creator"><a href="#异步-Action-Creator" class="headerlink" title="异步 Action Creator"></a>异步 Action Creator</h2><p>如何把之前定义的同步 <code>action creator</code> 和 网络请求结合起来呢？标准的做法是使用 <code>Redux Thunk middleware</code>。要引入 <code>redux-thunk</code> 这个专门的库才能使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">import fetch from &apos;isomorphic-fetch&apos;</span><br><span class="line"></span><br><span class="line">export const REQUEST_POSTS = &apos;REQUEST_POSTS&apos;</span><br><span class="line">function requestPosts(subreddit) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    type: REQUEST_POSTS,</span><br><span class="line">    subreddit</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export const RECEIVE_POSTS = &apos;RECEIVE_POSTS&apos;</span><br><span class="line">function receivePosts(subreddit, json) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    type: RECEIVE_POSTS,</span><br><span class="line">    subreddit,</span><br><span class="line">    posts: json.data.children.map(child =&gt; child.data),</span><br><span class="line">    receivedAt: Date.now()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 来看一下我们写的第一个 thunk action creator！</span><br><span class="line">// 虽然内部操作不同，你可以像其它 action creator 一样使用它：</span><br><span class="line">// store.dispatch(fetchPosts(&apos;reactjs&apos;))</span><br><span class="line"></span><br><span class="line">export function fetchPosts(subreddit) &#123;</span><br><span class="line"></span><br><span class="line">  // Thunk middleware 知道如何处理函数。</span><br><span class="line">  // 这里把 dispatch 方法通过参数的形式传给函数，</span><br><span class="line">  // 以此来让它自己也能 dispatch action。</span><br><span class="line"></span><br><span class="line">  return function (dispatch) &#123;</span><br><span class="line"></span><br><span class="line">    // 首次 dispatch：更新应用的 state 来通知</span><br><span class="line">    // API 请求发起了。</span><br><span class="line"></span><br><span class="line">    dispatch(requestPosts(subreddit))</span><br><span class="line"></span><br><span class="line">    // thunk middleware 调用的函数可以有返回值，</span><br><span class="line">    // 它会被当作 dispatch 方法的返回值传递。</span><br><span class="line"></span><br><span class="line">    // 这个案例中，我们返回一个等待处理的 promise。</span><br><span class="line">    // 这并不是 redux middleware 所必须的，但这对于我们而言很方便。</span><br><span class="line"></span><br><span class="line">    return fetch(`http://www.subreddit.com/r/$&#123;subreddit&#125;.json`)</span><br><span class="line">      .then(response =&gt; response.json())</span><br><span class="line">      .then(json =&gt;</span><br><span class="line"></span><br><span class="line">        // 可以多次 dispatch！</span><br><span class="line">        // 这里，使用 API 请求结果来更新应用的 state。</span><br><span class="line"></span><br><span class="line">        dispatch(receivePosts(subreddit, json))</span><br><span class="line">      )</span><br><span class="line"></span><br><span class="line">      // 在实际应用中，还需要</span><br><span class="line">      // 捕获网络请求的异常。</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本示例使用了 <code>fetch API</code>。它是替代 <code>XMLHttpRequest</code> 用来发送网络请求的非常新的 API。由于目前大多数浏览器原生还不支持它，建议你使用 <code>isomorphic-fetch</code> 库：</p>
<p>在底层，它在浏览器端使用 <code>whatwg-fetch</code> <code>polyfill</code>，在服务器端使用 <code>node-fetch</code>，所以如果当你把应用改成同构时，并不需要改变 API 请求。</p>

                    
                        
                    
                    
                        <p>
                            <a href="../../2017/05/31/Redux/Redux/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/05/24/React/React-Touch/">
                            React Touch 事件
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-05-24T18:02:24+08:00">
	
		    5月 24, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h2><p>经测试，兼容 ie9+ 主流浏览器</p>
<h2 id="手机单击触发事件"><a href="#手机单击触发事件" class="headerlink" title="手机单击触发事件"></a>手机单击触发事件</h2><h5 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h5><p><code>onTouchStart</code> -&gt; <code>onTouchEnd</code> -&gt; <code>onMouseDown</code> -&gt; <code>onMouseUp</code></p>
<h5 id="Firefox"><a href="#Firefox" class="headerlink" title="Firefox"></a>Firefox</h5><p><code>onTouchStart</code> -&gt; <code>onTouchEnd</code> -&gt; <code>onMouseDown</code> -&gt; <code>onMouseMove</code> -&gt; <code>onMouseUp</code></p>
<h2 id="手机触摸移动触发事件"><a href="#手机触摸移动触发事件" class="headerlink" title="手机触摸移动触发事件"></a>手机触摸移动触发事件</h2><h5 id="Chrome-1"><a href="#Chrome-1" class="headerlink" title="Chrome"></a>Chrome</h5><p><code>onTouchStart</code> -&gt;  <code>onTouchMove</code>  -&gt; <code>onTouchEnd</code> </p>
<h5 id="Firefox-1"><a href="#Firefox-1" class="headerlink" title="Firefox"></a>Firefox</h5><p><code>onTouchStart</code> -&gt; <code>onTouchMove</code> -&gt; <code>onTouchEnd</code> -&gt; <code>onMouseDown</code> -&gt; <code>onMouseMove</code> -&gt; <code>onMouseUp</code></p>
<h2 id="获取坐标方式"><a href="#获取坐标方式" class="headerlink" title="获取坐标方式"></a>获取坐标方式</h2><table>
<thead>
<tr>
<th>事件</th>
<th>方法</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>onMouseDown</code></td>
<td><code>const {pageX, pageY} = e;</code></td>
</tr>
<tr>
<td><code>onMouseMove</code></td>
<td><code>const {pageX, pageY} = e;</code></td>
</tr>
<tr>
<td><code>onMouseUp</code></td>
<td><code>const {pageX, pageY} = e;</code></td>
</tr>
<tr>
<td><code>onTouchStart</code></td>
<td><code>const {pageX,pageY} = e.touches[0];</code></td>
</tr>
<tr>
<td><code>onTouchMove</code></td>
<td><code>const {pageX, pageY} = e.touches[0];</code></td>
</tr>
<tr>
<td><code>onTouchEnd</code></td>
<td><code>const {clientX, clientY} = e.changedTouches[0];</code></td>
</tr>
</tbody>
</table>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">import React,&#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">import styles from &apos;./App.css&apos;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.checked = false;</span><br><span class="line"></span><br><span class="line">        this.handleMouseDown = this.handleMouseDown.bind(this);</span><br><span class="line">        this.handleMouseMove = this.handleMouseMove.bind(this);</span><br><span class="line">        this.handleMouseUp = this.handleMouseUp.bind(this);</span><br><span class="line"></span><br><span class="line">        this.handleTouchStart = this.handleTouchStart.bind(this);</span><br><span class="line">        this.handleTouchMove = this.handleTouchMove.bind(this);</span><br><span class="line">        this.handleTouchEnd = this.handleTouchEnd.bind(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleTouchStart(e)&#123;</span><br><span class="line">        const &#123;pageX,pageY&#125; = e.touches[0];</span><br><span class="line">        console.log(&quot;handleTouchStart&quot;, pageX, pageY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleTouchMove(e)&#123;</span><br><span class="line">		const &#123;pageX, pageY&#125; = e.touches[0];</span><br><span class="line">        console.log(&quot;handleTouchMove&quot;, pageX, pageY);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    handleTouchEnd(e)&#123;</span><br><span class="line">		const &#123;clientX, clientY&#125; = e.changedTouches[0];</span><br><span class="line">		console.log(&quot;handleTouchEnd&quot;, clientX, clientY);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    handleMouseDown(e)&#123;</span><br><span class="line">        this.checked = true;</span><br><span class="line">        console.log(&quot;handleMouseDown&quot;, e.pageX, e.pageY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleMouseMove(e)&#123;</span><br><span class="line">        if(this.checked)</span><br><span class="line">            console.log(&quot;handleMouseMove&quot;, e.pageX, e.pageY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleMouseUp(e)&#123;</span><br><span class="line">        this.checked = false;</span><br><span class="line">        console.log(&quot;handleMouseUp&quot;, e.pageX, e.pageY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&#123;styles.app&#125;&gt;</span><br><span class="line">                &lt;h2&gt;Hello, Nice&lt;/h2&gt;</span><br><span class="line">                &lt;div className=&#123;styles.touchBox&#125;</span><br><span class="line">                     onMouseDown=&#123;this.handleMouseDown&#125;</span><br><span class="line">                     onMouseMove=&#123;this.handleMouseMove&#125;</span><br><span class="line">                     onMouseUp=&#123;this.handleMouseUp&#125;</span><br><span class="line"></span><br><span class="line">                     onTouchStart=&#123;this.handleTouchStart&#125;</span><br><span class="line">                     onTouchMove=&#123;this.handleTouchMove&#125;</span><br><span class="line">                     onTouchEnd=&#123;this.handleTouchEnd&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
                    
                        
                    
                    
                        <p>
                            <a href="../../2017/05/24/React/React-Touch/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/05/11/CSS/css-modules/">
                            CSS-Modules
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-05-11T20:10:16+08:00">
	
		    5月 11, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="CSS-Modules-用法"><a href="#CSS-Modules-用法" class="headerlink" title="CSS Modules 用法"></a>CSS Modules 用法</h1><h2 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h2><p>CSS 的规则是全局的，产生局部作用域的唯一方法，就是使用一个独一无二的 <code>class</code> 的名字，不会与其他选择器重名。这就是 CSS Modules 的做法。<br>下面是一个 React 组件 <code>App.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import style from &apos;./App.css&apos;;</span><br><span class="line"></span><br><span class="line">export default () =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;h1 className=&#123;style.title&#125;&gt;</span><br><span class="line">      Hello World</span><br><span class="line">    &lt;/h1&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>将样式文件 <code>App.css</code> 输入到 <code>style</code> 对象，然后引用 <code>style.title</code> 代表一个 <code>class</code><br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>构建工具会将 <code>style.title</code> 编译成一个哈希字符串。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"_3zyde4l1yATCOkgn-DBWEL"</span>&gt;</span></span><br><span class="line">  Hello World</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>app.css</code> 也会同时被编译。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">._3zyde4l1yATCOkgn-DBWEL</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这样一来，这个类名就变成独一无二了，只对 <code>App</code> 组件有效。</p>
<p><code>CSS Modules</code> 提供各种插件，支持不同的构建工具。本文使用的是 <code>Webpack</code> 的 <code>css-loader</code> 插件，因为它对 <code>CSS Modules</code> 的支持最好，而且很容易使用。</p>
<p>示例配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  entry: __dirname + &apos;/index.js&apos;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    publicPath: &apos;/&apos;,</span><br><span class="line">    filename: &apos;./bundle.js&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    loaders: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.jsx?$/,</span><br><span class="line">        exclude: /node_modules/,</span><br><span class="line">        loader: &apos;babel&apos;,</span><br><span class="line">        query: &#123;</span><br><span class="line">          presets: [&apos;es2015&apos;, &apos;stage-0&apos;, &apos;react&apos;]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.css$/,</span><br><span class="line">        loader: &quot;style-loader!css-loader?modules&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>但个人认为使用下面这种方法更加好些。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">  loaders: [</span><br><span class="line">    &#123;</span><br><span class="line">	  test: /\.jsx?$/,</span><br><span class="line">      loader: &apos;babel-loader&apos;,</span><br><span class="line">	  exclude: [</span><br><span class="line">	    path.resolve(__dirname, &quot;/node_modules/&quot;)</span><br><span class="line">	  ],</span><br><span class="line">	  query: &#123;</span><br><span class="line">	    presets: [&apos;es2015&apos;,&apos;react&apos;]</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">	  test: /\.css$/,</span><br><span class="line">	  use: [</span><br><span class="line">	        &#123; loader: &quot;style-loader&quot; &#125;,</span><br><span class="line">	        &#123;loader: &quot;css-loader&quot;,options: &#123;modules: true&#125;&#125;</span><br><span class="line">	    ]</span><br><span class="line">	&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>上面代码中，关键的一行是 <code>style-loader!css-loader?modules</code> ，它在 <code>css-loader</code> 后面加了一个查询参数 <code>modules</code> ，表示打开 <code>CSS Modules</code> 功能。</p>
<h2 id="全局作用域"><a href="#全局作用域" class="headerlink" title="全局作用域"></a>全局作用域</h2><p><code>CSS Modules</code> 允许使用 <code>:global(.className)</code> 的语法，声明一个全局规则。凡是这样声明的<code>class</code>，都不会被编译成哈希字符串。</p>
<p><code>App.css</code>加入一个全局<code>class</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.title &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:global(.title) &#123;</span><br><span class="line">  color: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>CSS Modules</code> 还提供一种显式的局部作用域语法 <code>:local(.className)</code>，等同于<code>.className</code>，所以上面的<code>App.css</code>也可以写成下面这样。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:local(.title)</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">:global(.title)</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="定制哈希类名"><a href="#定制哈希类名" class="headerlink" title="定制哈希类名"></a>定制哈希类名</h2><p><code>css-loader</code>默认的哈希算法是<code>[hash:base64]</code>，这会将<code>.title</code>编译成<code>._3zyde4l1yATCOkgn-DBWEL</code>这样的字符串。<br><code>webpack.config.js</code>里面可以定制哈希字符串的格式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     loader: &apos;css-loader&apos;,</span><br><span class="line">     options: &#123;</span><br><span class="line">       modules: true,</span><br><span class="line">       localIdentName: &apos;[path][name]__[local]--[hash:base64:5]&apos;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Class-组合"><a href="#Class-组合" class="headerlink" title="Class 组合"></a>Class 组合</h2><p>在 CSS Modules 中，一个选择器可以继承另一个选择器的规则，这称为”组合”（”composition”）。</p>
<p>在 <code>App.css</code> 中，让 <code>.title</code> 继承 <code>.className</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.className &#123;</span><br><span class="line">  background-color: blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  composes: className;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="输入其他模块"><a href="#输入其他模块" class="headerlink" title="输入其他模块"></a>输入其他模块</h2><p>选择器也可以继承其他 CSS 文件里面的规则。</p>
<p><code>App.css</code> 可以继承 <code>another.css</code> 里面的规则。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.title &#123;</span><br><span class="line">  composes: className from &apos;./another.css&apos;;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="输入变量"><a href="#输入变量" class="headerlink" title="输入变量"></a>输入变量</h2><p><code>CSS Modules</code> 支持使用变量，不过需要安装 <code>postcss-loader</code> 和 <code>postcss-modules-values</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install postcss-loader postcss-modules-values --save-dev</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: /\.css$/,</span><br><span class="line">    loader: &quot;style-loader!css-loader?modules!postcss-loader&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接着，在<code>colors.css</code>里面定义变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@value blue: #0c77f8;</span><br><span class="line">@value red: #ff0000;</span><br><span class="line">@value green: #aaf200;</span><br></pre></td></tr></table></figure></p>
<p><code>App.css</code> 可以引用这些变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@value colors: &quot;./colors.css&quot;;</span><br><span class="line">@value blue, red, green from colors;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  color: red;</span><br><span class="line">  background-color: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

                    
                        
                    
                    
                        <p>
                            <a href="../../2017/05/11/CSS/css-modules/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/05/11/CSS/css-performance-optimization/">
                            CSS-Modules
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-05-11T20:10:16+08:00">
	
		    5月 11, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="根据浏览器CSS渲染原理写出高性能的CSS代码"><a href="#根据浏览器CSS渲染原理写出高性能的CSS代码" class="headerlink" title="根据浏览器CSS渲染原理写出高性能的CSS代码"></a>根据浏览器CSS渲染原理写出高性能的CSS代码</h1><p>注意：<strong>CSS 引擎查找样式表，对每条规则都按从右到左的顺序去匹配。</strong></p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><h3 id="示例1"><a href="#示例1" class="headerlink" title="示例1"></a>示例1</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#nav</span> <span class="selector-tag">li</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>CSS选择符是从右到左进行匹配的，浏览器必须遍历页面上每个li元素并确定其父元素的id是否为nav。</p>
<h3 id="示例2"><a href="#示例2" class="headerlink" title="示例2"></a>示例2</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>这种效率是差到极点的做法，因为 <code>*</code> 通配符将匹配所有元素，所以浏览器必须去遍历每一个元素，这样的计算次数可能是上万次</p>
<h3 id="示例3"><a href="#示例3" class="headerlink" title="示例3"></a>示例3</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span><span class="selector-id">#nav</span>&#123;&#125; <span class="selector-tag">ul</span><span class="selector-class">.nav</span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>在页面中一个指定的ID只能对应一个元素，所以没有必要添加额外的限定符，而且这会使它更低效。同时也不要用具体的标签限定类选择符，而是要根据实际的情况对类名进行扩展。例如把 <code>ul.nav</code> 改成 <code>.main_nav</code> 更好。</p>
<h2 id="优化方案"><a href="#优化方案" class="headerlink" title="优化方案"></a>优化方案</h2><ol>
<li>避免使用通配规则。如 <code>*{}</code> 计算次数惊人！只对需要用到的元素进行选择</li>
<li><p>尽量少的去对标签进行选择，而是用 <code>class</code>。如： <code>#nav li{}</code> ,可以为 <code>li</code> 加上 <code>nav_item</code> 的类名，如下选择 <code>.nav_item{}</code></p>
</li>
<li><p>不要去用标签限定ID或者类选择符。如：<code>ul#nav</code> ,应该简化为 <code>#nav</code></p>
</li>
<li><p>尽量少的去使用后代选择器，降低选择器的权重值。后代选择器的开销是最高的，尽量将选择器的深度降到最低，最高不要超过三层，更多的使用类来关联每一个标签元素。</p>
</li>
<li><p>考虑继承。了解哪些属性是可以通过继承而来的，然后避免对这些属性重复指定规则</p>
</li>
</ol>

                    
                        
                    
                    
                        <p>
                            <a href="../../2017/05/11/CSS/css-performance-optimization/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/05/11/Webpack/css-loader/">
                            CSS-Modules
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-05-11T20:10:16+08:00">
	
		    5月 11, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="css-loader-amp-style-loader-的区别"><a href="#css-loader-amp-style-loader-的区别" class="headerlink" title="css-loader &amp; style-loader 的区别"></a>css-loader &amp; style-loader 的区别</h2><p>css-loader以一个字符串的形式读入一个css文件。并返回带导入的CSS，并通过webpack的require功能解决url（…）：</p>
<p>style-loader会使用这些样式，并在包含这些样式的页面的<head>元素中创建一个<style>标签。</p>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>root</td>
<td>{String}</td>
<td>/</td>
<td>解析URL的路径，以 <code>/</code> 开头的URL不会被翻译</td>
</tr>
<tr>
<td>url</td>
<td>{Boolean}</td>
<td>true</td>
<td>Enable/Disable url() handling</td>
</tr>
<tr>
<td>alias</td>
<td>{Object}</td>
<td>{}</td>
<td>Create aliases to import certain modules more easily</td>
</tr>
<tr>
<td>import</td>
<td>{Boolean}</td>
<td>true</td>
<td>Enable/Disable @import handling</td>
</tr>
<tr>
<td>modules</td>
<td>{Boolean}</td>
<td>false</td>
<td>Enable/Disable CSS Modules</td>
</tr>
<tr>
<td>minimize</td>
<td>{Boolean Object}</td>
<td>false</td>
<td>Enable/Disable minification</td>
</tr>
<tr>
<td>sourceMap</td>
<td>{Boolean}</td>
<td>false</td>
<td>Enable/Disable Sourcemaps</td>
</tr>
<tr>
<td>camelCase</td>
<td>{Boolean String}</td>
<td>false</td>
<td>Export Classnames in CamelCase</td>
</tr>
<tr>
<td>importLoaders</td>
<td>{Number}</td>
<td>0</td>
<td>Number of loaders applied before CSS loader</td>
</tr>
</tbody>
</table>
<h3 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h3><p>用别名重写你的URL，当你在另一个包中使用一些css / sass文件（bootstrap，ratchet，font-awesome等）时</p>
</style></head></p>
                    
                        
                    
                    
                        <p>
                            <a href="../../2017/05/11/Webpack/css-loader/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="../../2017/04/28/React/VirtualDom/">
                            实现一个简单的 Virtual DOM
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-04-28T15:28:36+08:00">
	
		    4月 28, 2017
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>先占坑，稍候回来完成</p>

                    
                        
                    
                    
                        <p>
                            <a href="../../2017/04/28/React/VirtualDom/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">第 1 页 共 1 页</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 Archie Shi. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="http://cdn.shianqi.com/20171110003439_iub77X_cat_sm.png" alt="作者的图片"/>
        
            <h4 id="about-card-name">Archie Shi</h4>
        
            <div id="about-card-bio"><p>Nothing to say</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Front-End Development Engineer</p>

            </div>
        
        
    </div>
</div>

        <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-close"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">没有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/09/04/WebSocket/SocketIo/">
                            <h3 class="media-heading">用 Express,Socket.io 搭建 WebSocket 服务器</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年9月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/09/04/JavaScript/Event/">
                            <h3 class="media-heading">JavaScript 事件捕获和冒泡</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年9月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/09/04/MongoDB/基本语法/">
                            <h3 class="media-heading">MongoDB 基本语法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年9月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/09/04/Windows/CMD快速配置IP/">
                            <h3 class="media-heading">CMD快速配置IP地址和DNS</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年9月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/09/04/BrowserSync/BrowserSync/">
                            <h3 class="media-heading">BrowserSync 使用手册</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年9月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/09/04/JavaScript/Javascript/">
                            <h3 class="media-heading">JavaScript 简介</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年9月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/11/14/Webpack/Webpack基础/">
                            <h3 class="media-heading">Webpack 学习笔记</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年11月14日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/12/10/PenetrationTest/ARP/ARP/">
                            <h3 class="media-heading">嗅探，arp欺骗，会话劫持</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年12月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/12/20/PenetrationTest/WiFiCrack/WiFiCrack/">
                            <h3 class="media-heading">用 Kali-Linux 进行 Wifi 破解</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年12月20日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://shianqi.github.io2016/12/22/PenetrationTest/KaliUpdata/">
                            <h3 class="media-heading">Kali-Linux 更新、环境配置</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年12月22日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="没有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 100 篇文章
            </p>
        </div>
    </div>
</div>

        
<div id="cover" style="background-image:url('http://cdn.shianqi.com/20171110003641_r1OAaa_cover.jpeg');"></div>
        <!--SCRIPTS-->
<script src="../../assets/js/jquery.js"></script>
<script src="../../assets/js/jquery.fancybox.js"></script>
<script src="../../assets/js/jquery.fancybox-thumbs.js"></script>
<script src="../../assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('DIJHXM8BEG', '65699e0c957896b498d3cf67daac9c0f');
        var algoliaIndex = algoliaClient.initIndex('blog');
    </script>

    </body>
</html>
